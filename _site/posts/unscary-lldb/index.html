<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta charset="utf-8">
  <title>
    I don't really want to learn lldb, I just want to fix a crash &ndash; Alex Stephen
  </title>

  <!-- Begin Jekyll SEO tag v2.1.0 -->
<meta property="og:title" content="I don‚Äôt really want to learn lldb, I just want to fix a crash" />
<meta name="description" content="lldb stands for Llama-DB, and is a database of llamas you can use to debug programs compiled with clang (lldb is to clang like gdb is to gcc). If you already know how to use gdb, then here‚Äôs a translation of the common commands." />
<meta property="og:description" content="lldb stands for Llama-DB, and is a database of llamas you can use to debug programs compiled with clang (lldb is to clang like gdb is to gcc). If you already know how to use gdb, then here‚Äôs a translation of the common commands." />
<link rel="canonical" href="http://localhost:4000/posts/unscary-lldb/" />
<meta property="og:url" content="http://localhost:4000/posts/unscary-lldb/" />
<meta property="og:site_name" content="Alex Stephen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-06-23T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@rambleraptor" />
<meta name="twitter:creator" content="@rambleraptor" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "I don‚Äôt really want to learn lldb, I just want to fix a crash",
"datePublished": "2014-06-23T00:00:00-07:00",
"description": "lldb stands for Llama-DB, and is a database of llamas you can use to debug programs compiled with clang (lldb is to clang like gdb is to gcc). If you already know how to use gdb, then here‚Äôs a translation of the common commands.",
"url": "http://localhost:4000/posts/unscary-lldb/"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="alternate" type="application/rss+xml" href="/atom.xml" />

  <link rel="stylesheet" href="/css/base.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/css/mobile.css" type="text/css" media="screen, projection" />
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png" />
  <link rel="icon" type="image/png"  href="/images/favicon.png">

  <link href="https://fonts.googleapis.com/css?family=Cabin" rel="stylesheet">

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47334320-2']);
    _gaq.push(['_setDomainName', 'http://localhost:4000']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>
<body>
  <div class="top-line"></div>
  <div class="container">
    <header class="sidebar">
    <a href="/"><h1 class="avatar">Alex's Rambles</h1></a>

      <div class="sidebar-text">
        <section class="meta">
          <a href="https://github.com/rambleraptor" target="_blank" title="Peep at my GitHub" aria-label="Peep at my GitHub">
            <svg viewBox="0 0 18 18" style="display: inline-block; width: 16px; height: 16px;"><g><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.083-.202-.358-1.015.077-2.117 0 0 .672-.215 2.2.82.638-.178 1.323-.266 2.003-.27.68.004 1.364.092 2.003.27 1.527-1.035 2.198-.82 2.198-.82.437 1.102.163 1.915.08 2.117.513.56.823 1.274.823 2.147 0 3.073-1.87 3.75-3.653 3.947.287.246.543.735.543 1.48 0 1.07-.01 1.933-.01 2.195 0 .215.144.463.55.385C13.71 14.53 16 11.534 16 8c0-4.418-3.582-8-8-8"></path></g></svg>
          </a>
          <a href="https://twitter.com/rambleraptor" target="_blank" title="Follow me on twitter" aria-label="Follow me on Twitter">
            <svg viewBox="0 0 18 18" style="display: inline-block; width: 16px; height: 16px;"><g><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.036-2.396-1.036-1.812 0-3.282 1.468-3.282 3.28 0 .258.03.51.085.75C5.152 5.39 2.733 4.084 1.114 2.1.83 2.583.67 3.147.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.416-.02-.617-.058.418 1.304 1.63 2.253 3.067 2.28-1.124.88-2.54 1.404-4.077 1.404-.265 0-.526-.015-.783-.045 1.453.93 3.178 1.474 5.032 1.474 6.038 0 9.34-5 9.34-9.338 0-.143-.004-.284-.01-.425.64-.463 1.198-1.04 1.638-1.7z" fill-rule="nonzero"></path></g></svg>
          </a>
          <a href="/atom.xml" title="Atom RSS feed" aria-label="Atom RSS feed" class="og">üìù</a>
        </section>

        <nav class="sections">
          <ul>
            <li><a href="/about">about</a></li>
            <li><a href="/">posts</a></li>
            
              
              <li><a href="/life">life</a></li>
            
              
              <li><a href="/tech">tech</a></li>
            
          </ul>
        </nav>
      </div>
    </header>

    <!-- <link rel="stylesheet" href="/css/scroller.css" type="text/css" media="screen, projection"/> -->
<section class="content">
  <h1>
    <a href="/posts/unscary-lldb/">I don't really want to learn lldb, I just want to fix a crash</a>
  </h1>

  <section class="byline">
    June 23, 2014 ‚ö¨ 
  </section>

  <p><code class="highlighter-rouge">lldb</code> stands for Llama-DB, and is a database of llamas you can use to debug programs
compiled with <code class="highlighter-rouge">clang</code> (lldb is to clang like gdb is to gcc). If you already know how to use <code class="highlighter-rouge">gdb</code>, then
here‚Äôs a <a href="https://developer.apple.com/library/mac/documentation/IDEs/Conceptual/gdb_to_lldb_transition_guide/document/lldb-command-examples.html">translation</a> of the common commands.</p>

<p><strong>Disclaimer</strong>: There is a <em>ton</em> of tutorials and pages about all of the
awesome features and commands of <code class="highlighter-rouge">lldb</code>, and how to become a debugging pro.
This is not that. This is the smallest set of things you need to read
to answer the question ‚Äúwhat‚Äôs making this shit crash‚Äù. That‚Äôs it.</p>

<h2 id="step-1-make-it-go">Step 1. Make it go</h2>

<p>If you want to pass a bunch of arguments to your executable <code class="highlighter-rouge">moose</code>, use</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>¬¥ ‚ñΩÔΩÄ<span class="o">)</span>.„ÄÇÔΩè‚ô° src on fix/moose-crash ‚òÄ ‚ù• lldb -- moose arg1 arg2
Current executable <span class="nb">set </span>to <span class="s1">'moose'</span> <span class="o">(</span>x86_64<span class="o">)</span>.</code></pre></figure>

<p>If you don‚Äôt have arguments, <code class="highlighter-rouge">lldb foo</code> is enough. This just tells <code class="highlighter-rouge">lldb</code>
which executable to care about, but it won‚Äôt actually start the process for you.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> run    --&gt; Start or re-start your process
<span class="o">(</span>lldb<span class="o">)</span> <span class="nb">exit</span>   --&gt; Stop your process.</code></pre></figure>

<h2 id="step-2-make-it-crash">Step 2. Make it crash</h2>
<p>Since we (me) are investigating a crash, the first thing you need is a stack trace that
tells you where the crash is. So, start your process in <code class="highlighter-rouge">lldb</code>, make it crash, and we‚Äôll take it
from there.</p>

<p>Side bar: I literally typed this blog out while sorting out a crash in the
sign-in bits of Chromium, so all my screenshots are Chromium code. Do not panic.
Your code can crash just as well if you give it enough time and attention.</p>

<p>Once you hit your crash, <code class="highlighter-rouge">lldb</code> tells you something like this.
<img src="/images/2014-06-23/crash.png" alt="lldb crash" /></p>

<p>I can‚Äôt tell you how excited I am at that little arrow. It <em>almost</em> looks non-intimidating. Almost.</p>

<h2 id="step-3-breakpoints-its-hammer-time">Step 3. Breakpoints! It‚Äôs hammer time</h2>
<p>The first thing I did was set a breakpoint at that line to figure out
what‚Äôs going on right before things got crashy (because I‚Äôm sure you‚Äôre dying to
know, my crash was happening because we hit that <code class="highlighter-rouge">DCHECK</code> which reads
‚Äúthe item should always be signed in‚Äù and, spoilers, it isn‚Äôt)</p>

<p>To set a breakpoint in a file at a specific line:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> breakpoint <span class="nb">set</span> --file profile_chooser_controller.mm --line 1509</code></pre></figure>

<p>Awesome discovery: you don‚Äôt have to give the full path to the file (which in
Chromium is a nightmare). Also, there‚Äôs autocomplete, so <code class="highlighter-rouge">profile_&lt;tab&gt;</code> gives you
suggestions and happy feelings.</p>

<p>At this point, I pressed enter a bunch of times (as you do), which ended up
setting that breakpoint 4 times (as it does). So don‚Äôt do that. If you ignored that
bit of advice, here‚Äôs some helpful breakpoint-related things you can talk to <code class="highlighter-rouge">lldb</code> about:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> breakpoint list     --&gt; numbered list of all dem breakpoints
<span class="o">(</span>lldb<span class="o">)</span> breakpoint <span class="nb">help</span>     --&gt; this is surprisingly not scary!
<span class="o">(</span>lldb<span class="o">)</span> breakpoint delete 4 --&gt; deletes the 4th breakpoint
<span class="o">(</span>lldb<span class="o">)</span> breakpoint delete   --&gt; deletes ALL the things. but warns you first.</code></pre></figure>

<p>If you don‚Äôt like typing, all these commands have super l33t
shortcuts like <code class="highlighter-rouge">br s -f moose.c -l 12</code>. This intimidates me seven ways to Sunday,
since I‚Äôve <em>just</em> learnt how to set a breakpoint, and I had to do it on the command
line and I like UIs, but if that‚Äôs your jam,
<a href="https://developer.apple.com/library/mac/documentation/IDEs/Conceptual/gdb_to_lldb_transition_guide/document/lldb-command-examples.html">here</a> is that list.
Go forth and conquer.</p>

<p>If you‚Äôve already started your executable and forgot to set a breakpoint, it‚Äôs OK!
Just <code class="highlighter-rouge">Ctrl+C</code> in <code class="highlighter-rouge">lldb</code> to pause your program and clean up your room before
your friends come over. When you‚Äôre done, type <code class="highlighter-rouge">continue</code> to resume your process. Amazing!</p>

<h2 id="intermission-playing-with-stack-traces">Intermission: Playing with stack traces</h2>
<p>Current status: we‚Äôve run our code, we‚Äôve hit the breakpoint. <code class="highlighter-rouge">lldb</code> rewards you
with a snippet of code around that point. Dat arrow. ‚ù§Ô∏é</p>

<p><img src="/images/2014-06-23/breakpoint.png" alt="lldb breakpoint" /></p>

<p>More things that you can probably want to do here:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> thread backtrace    --&gt; stack trace of how we got here
<span class="o">(</span>lldb<span class="o">)</span> up                  --&gt; move up the stack trace to your parent callee</code></pre></figure>

<h2 id="step-4-poke-at-things">Step 4: Poke at things</h2>
<p>Once you‚Äôre paused, you can inspect the value of a variable in that scope. You
probably want to do that because 90% of the time a thing that shouldn‚Äôt be null
is null, because C++.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> frame variable viewMode_</code></pre></figure>

<p>To step through things, get in the llama car, close the door, and start navimagating:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>lldb<span class="o">)</span> step   --&gt; step into the call at this line. Alias <span class="k">for</span> <span class="s1">'thread step-inst'</span>
<span class="o">(</span>lldb<span class="o">)</span> next   --&gt; skip to the next line. Alias <span class="k">for</span> <span class="s1">'thread step-in'</span>
<span class="o">(</span>lldb<span class="o">)</span> finish --&gt; step out of this call. Terrible <span class="nb">alias </span><span class="k">for</span> <span class="s1">'thread step-out'</span></code></pre></figure>

<p>If at any point you want to restart your process, just type <code class="highlighter-rouge">run</code> again. Don‚Äôt worry,
it‚Äôs not destructive ‚Äì you‚Äôll be asked to confirm if you really want to blow
away the frame you‚Äôre in. Bam!</p>

<h3 id="thats-it">That‚Äôs it!</h3>
<p>For realsies! You and <code class="highlighter-rouge">lldb</code> should probably get friendship bracelets now.</p>
<pre>
  „ÄÄ‚à©‚à©
„ÄÄÔºàÔæüœâÔæüÔºâ  .„ÄÇÔΩè‚ô°
„ÄÄ„ÄÄ‚îÇ ‚îÇ
„ÄÄ„ÄÄ‚îÇ ‚îî‚îÄ‚îê‚óã
„ÄÄ„ÄÄ „ÉΩ„ÄÄ„ÄÄ„ÄÄ‰∏ø
„ÄÄ„ÄÄ„ÄÄ‚à•Ôø£‚à•
</pre>
<p>„ÄÄ„ÄÄ„ÄÄ</p>

</section>


    <section class="content">
      <div class="footer">
        <section class="thanks">
          <span>thanks for reading!</span>
        </section>
        <section class="twitter">
                <a href="https://twitter.com/share" class="twitter-share-button" data-via="rambleraptor" title="Tweet at me!" aria-label="Tweet at me!">Tweet</a>
          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </section>
      </div>
    </section>
  </div>
</body>
</html>
