<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta charset="utf-8">
  <title>
    When pull requests get tricky &ndash; Alex Stephen
  </title>

  <!-- Begin Jekyll SEO tag v2.1.0 -->
<meta property="og:title" content="When pull requests get tricky" />
<meta name="description" content="Imagine this: you have forked a repo a long time ago and have since been in a happily committed relationship with the master branch, modifying files and committing from the hip." />
<meta property="og:description" content="Imagine this: you have forked a repo a long time ago and have since been in a happily committed relationship with the master branch, modifying files and committing from the hip." />
<link rel="canonical" href="http://localhost:4000/posts/tricky-pull-requests/" />
<meta property="og:url" content="http://localhost:4000/posts/tricky-pull-requests/" />
<meta property="og:site_name" content="Alex Stephen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-02-25T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@rambleraptor" />
<meta name="twitter:creator" content="@rambleraptor" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "When pull requests get tricky",
"datePublished": "2014-02-25T00:00:00-08:00",
"description": "Imagine this: you have forked a repo a long time ago and have since been in a happily committed relationship with the master branch, modifying files and committing from the hip.",
"url": "http://localhost:4000/posts/tricky-pull-requests/"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="alternate" type="application/rss+xml" href="/atom.xml" />

  <link rel="stylesheet" href="/css/base.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/css/mobile.css" type="text/css" media="screen, projection" />
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png" />
  <link rel="icon" type="image/png"  href="/images/favicon.png">

  <link href="https://fonts.googleapis.com/css?family=Cabin" rel="stylesheet">

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47334320-2']);
    _gaq.push(['_setDomainName', 'http://localhost:4000']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>
<body>
  <div class="top-line"></div>
  <div class="container">
    <header class="sidebar">
    <a href="/"><h1 class="avatar">Alex's Rambles</h1></a>

      <div class="sidebar-text">
        <section class="meta">
          <a href="https://github.com/rambleraptor" target="_blank" title="Peep at my GitHub" aria-label="Peep at my GitHub">
            <svg viewBox="0 0 18 18" style="display: inline-block; width: 16px; height: 16px;"><g><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.083-.202-.358-1.015.077-2.117 0 0 .672-.215 2.2.82.638-.178 1.323-.266 2.003-.27.68.004 1.364.092 2.003.27 1.527-1.035 2.198-.82 2.198-.82.437 1.102.163 1.915.08 2.117.513.56.823 1.274.823 2.147 0 3.073-1.87 3.75-3.653 3.947.287.246.543.735.543 1.48 0 1.07-.01 1.933-.01 2.195 0 .215.144.463.55.385C13.71 14.53 16 11.534 16 8c0-4.418-3.582-8-8-8"></path></g></svg>
          </a>
          <a href="https://twitter.com/rambleraptor" target="_blank" title="Follow me on twitter" aria-label="Follow me on Twitter">
            <svg viewBox="0 0 18 18" style="display: inline-block; width: 16px; height: 16px;"><g><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.036-2.396-1.036-1.812 0-3.282 1.468-3.282 3.28 0 .258.03.51.085.75C5.152 5.39 2.733 4.084 1.114 2.1.83 2.583.67 3.147.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.416-.02-.617-.058.418 1.304 1.63 2.253 3.067 2.28-1.124.88-2.54 1.404-4.077 1.404-.265 0-.526-.015-.783-.045 1.453.93 3.178 1.474 5.032 1.474 6.038 0 9.34-5 9.34-9.338 0-.143-.004-.284-.01-.425.64-.463 1.198-1.04 1.638-1.7z" fill-rule="nonzero"></path></g></svg>
          </a>
          <a href="/atom.xml" title="Atom RSS feed" aria-label="Atom RSS feed" class="og">üìù</a>
        </section>

        <nav class="sections">
          <ul>
            <li><a href="/about">about</a></li>
            <li><a href="/">posts</a></li>
            
              
              <li><a href="/life">life</a></li>
            
              
              <li><a href="/tech">tech</a></li>
            
          </ul>
        </nav>
      </div>
    </header>

    <!-- <link rel="stylesheet" href="/css/scroller.css" type="text/css" media="screen, projection"/> -->
<section class="content">
  <h1>
    <a href="/posts/tricky-pull-requests/">When pull requests get tricky</a>
  </h1>

  <section class="byline">
    February 25, 2014 ‚ö¨ 
  </section>

  <p>Imagine this: you have forked a repo a long time ago and have since been in a happily committed relationship with the master branch, modifying files and committing from the hip.</p>

<p>In case you have doubts about the likelihood of this scenario, we‚Äôre talking about my <code class="highlighter-rouge">notwaldorf.github.com</code> blog branch, which I forked from <code class="highlighter-rouge">holman/left</code>. All my changes are on the master branch so that GitHub can do its magic gh-pages trick and just Make Things Work‚Ñ¢. This could also happen for repos you‚Äôve forked and mucked around with, but never thought you‚Äôd ever contribute to.</p>

<p>Because you‚Äôre a good open sorcerer, you might, at some point, want to send a pull request to fix a thing in the original repo. If you‚Äôre anything like I am, you are now in a bit of a terrible situation because your fork‚Äôs tip of tree has advanced and diverged quite a bit from the upstream repo, so any pull requests you send out will be polluted with code that doesn‚Äôt belong in them.</p>

<p>At this point, you probably have some regrets. Let‚Äôs not dwell on them. Here‚Äôs the set of steps that will help you navigate this minefield you find yourself in. They‚Äôre not special; I just couldn‚Äôt find them all in one place, and wanted a summary for the future. <a href="https://twitter.com/kmrhb">Kamal</a> figured most of this out, because he is a git wizard, while I am, most definitely, not.</p>

<h2 id="set-up-your-upstream">Set up your upstream</h2>
<p>If <code class="highlighter-rouge">git remote</code> doesn‚Äôt show you a branch called <code class="highlighter-rouge">upstream</code>, you need to add one:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git remote add upstream https://github.com/user/repo_you_forked.git
</code></pre>
</div>

<h2 id="set-up-a-clean-branch-for-your-fix">Set up a clean branch for your fix</h2>
<p>Step into your tardis and branch from when you were last in sync with the upstream. In my case, this was when I initially created my fork.
A dull perusing of <code class="highlighter-rouge">git log</code> or <code class="highlighter-rouge">git reflog</code> should point you to the right sha. Then,</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git checkout -b pr_branch
git reset --hard sha_from_the_past
</code></pre>
</div>

<h2 id="get-your-changes-in">Get your changes in</h2>
<p>Here you have two options. If your changes are tiny, or you know exactly what they are, you can just manually reapply them. And by that I mean copy paste the changes into the right files, like a barbarian. For the record, this is my preferred approach. I am a barbarian. I live in the git stone age.</p>

<p>Alternatively, you can go the fancy route with</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git checkout -p master file_to_modify
</code></pre>
</div>

<p>This will look at the diff between master (which is in the future), and your working copy (we are in the past) and let you pick and choose individual hunks. Having taken a moment and appreciated how amazing this last sentence was, you can:</p>

<ul>
  <li>hit <em>s</em> to split the hunks into smaller hunks</li>
  <li>hit <em>y</em> or <em>n</em> to pick or skip a hunk.</li>
</ul>

<p>If you‚Äôve touched any files, it would be a good time to do your familiar <code class="highlighter-rouge">git add/git commit</code> dance.</p>

<h2 id="merge-the-upstream-changes-in">Merge the upstream changes in</h2>
<div class="highlighter-rouge"><pre class="highlight"><code>git fetch upstream  # You won't see any changes in git log. Don't panic yet.
git merge upstream/master  # Some wild upstream changes appear in git log.
</code></pre>
</div>

<h2 id="--t-t-t-test-your-cha-an-ges--">‚ô´ ‚ô™ T-t-t-test your cha-an-ges ‚ô´ ‚ô™</h2>

<h2 id="upload-your-branch">Upload your branch</h2>
<p>This is the last step. If you want, you can rename your branch before uploading it. I usually do, because my original branch names tend to be silly. After this, you can go and look at your branch in GitHub and be delighted with the progress you‚Äôve made. Time to send out that pull request!</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git push origin pr_branch:possibly_new_branch_name
</code></pre>
</div>

<p><br />
Hope this helped!</p>

</section>


    <section class="content">
      <div class="footer">
        <section class="thanks">
          <span>thanks for reading!</span>
        </section>
        <section class="twitter">
                <a href="https://twitter.com/share" class="twitter-share-button" data-via="rambleraptor" title="Tweet at me!" aria-label="Tweet at me!">Tweet</a>
          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </section>
      </div>
    </section>
  </div>
</body>
</html>
